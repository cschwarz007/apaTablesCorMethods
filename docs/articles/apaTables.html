<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>apaTables • apaTables</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="apaTables">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">apaTables</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/apaTables.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dstanley4/apaTables">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>apaTables</h1>
                        <h4 class="author">David J. Stanley and Jeffrey R. Spence, University of Guelph</h4>
            
            <h4 class="date">2018-08-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dstanley4/apaTables/blob/master/vignettes/apaTables.Rmd"><code>vignettes/apaTables.Rmd</code></a></small>
      <div class="hidden name"><code>apaTables.Rmd</code></div>

    </div>

    
    
<div id="context" class="section level2">
<h2 class="hasAnchor">
<a href="#context" class="anchor"></a>Context</h2>
<p>Reproducible research is research for which the numbers reported in the paper can obtained by others using the original data and analysis scripts. (Note that this differs from replicability - the extent to which findings are consistent across samples.) Recent research has revealed a problem with the reproducibility of analyses in many fields. For example, in psychology Nuijten et al. (2015) found that in 50% of articles there was at least once instance of a reported test statistic (e.g., <em>t</em>(24)=22.71) being inconsistent with the reported <em>p</em>-value. This inconsistency rate suggests there is a major problem with reproducibility in the psychological literature.</p>
<p>My objective in creating the <em>apaTables</em> package was to automate the process through which tables are created from analyses when using R. Using <em>apaTables</em> ensures that the tables in your manuscript are reproducible.</p>
<p>Although a number of table generation packages exist for R they are typically not useful for psychology researchers because of the need to report results in the style required by the <a href="http://www.apa.org">American Psychological Association</a>; that is, <a href="http://www.apastyle.org/products/asc-landing-page.aspx">APA Style</a>. Consequently, <em>apaTables</em> creates <a href="https://products.office.com/en-ca/word">Microsoft Word</a> documents (.doc files) that contain tables that conform to APA Style.</p>
<p>In many cases it would be necessary to execute additional R commands to obtain all of the statistics needed for an APA Style table. For example, if conducting a regression using the <strong>lm</strong> command the unstandardized regression (i.e., b) weights are reported. Additional commands are needed to obtain standardized (i.e., beta) weights. <em>apaTables</em> automatically executes these additional commands to create a table with the required information in Microsoft Word .doc format<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>.</p>
<p>Additionally, the <a href="http://www.amstat.org">American Statistical Association</a> recently released a <a href="https://www.amstat.org/newsroom/pressreleases/P-ValueStatement.pdf">position paper</a> on the use of <em>p</em>-values in research. A component of that statement indicated that “<em>Scientific conclusions and business or policy decisions should not be based only on whether a p-value passes a specific threshold.</em>” The Executive Director of the <a href="http://www.amstat.org">ASA</a> suggested that <a href="http://retractionwatch.com/2016/03/07/were-using-a-common-statistical-test-all-wrong-statisticians-want-to-fix-that/">confidence intervals should be used to interpret data</a>. This statement is consistent with the 1999 <a href="http://www.apa.org/science/leadership/bsa/statistical/tfsi-followup-report.pdf">position paper</a> from the APA Task Force on Statistical Inference. Consequently, the current version of <em>apaTables</em> indicates significance using stars but more importantly reports confidence intervals for the reported effect sizes.</p>
<p>Bugs and feature requests can be reported at: <a href="https://github.com/dstanley4/apaTables/issues" class="uri">https://github.com/dstanley4/apaTables/issues</a></p>
</div>
<div id="correlation-table" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-table" class="anchor"></a>Correlation table</h2>
<p>Correlation tables can be constructed using the <strong>apa.cor.table</strong> function. The constructed table includes descriptive statistics (i.e., mean and standard deviation) for each variable and a confidence interval for each correlation.</p>
<p>The <strong>apa.cor.table</strong> function creates a correlation table with confidence intervals based on a data frame. The example below creates an APA Style correlation table, see Table 1, using the <em>attitude</em> dataset built into <em>R</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(apaTables)
<span class="kw"><a href="../reference/apa.cor.table.html">apa.cor.table</a></span>(attitude, <span class="dt">filename=</span><span class="st">"Table1_APA.doc"</span>, <span class="dt">table.number=</span><span class="dv">1</span>)</code></pre></div>
<div class="figure">
<img src="Table1.jpg" alt="Correlation table in MSWord"><p class="caption">Correlation table in MSWord</p>
</div>
</div>
<div id="regression-table-overview" class="section level2">
<h2 class="hasAnchor">
<a href="#regression-table-overview" class="anchor"></a>Regression table overview</h2>
<p>Regression tables can be constructed using the <strong>apa.reg.table</strong> function. The constructed table includes the unstandardized regression coefficient (<em>b</em> with CI), standardized regression coefficient (<em>beta</em> with CI), semi-partial correlation squared (<span class="math inline">\(sr^2\)</span> with CI), the correlation (<span class="math inline">\(r\)</span>), and the overall fit of the model (indexed by <span class="math inline">\(R^2\)</span> with CI). The <em>album</em> sales dataset from Field et al. (2012) is used to illustrate the <strong>apa.reg.table</strong> function (also see the <strong>apa.reg.boot.table</strong> function that works similarily but creates bootstrap confidence intervals).</p>
</div>
<div id="basic-regression-table" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-regression-table" class="anchor"></a>Basic regression table</h2>
<p>The <strong>apa.reg.table</strong> function creates a regression table with confidence intervals based on <strong>lm</strong> output; see Table 2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(apaTables)
basic.reg &lt;-<span class="st"> </span><span class="kw">lm</span>(sales <span class="op">~</span><span class="st"> </span>adverts <span class="op">+</span><span class="st"> </span>airplay, <span class="dt">data =</span> album)
<span class="kw"><a href="../reference/apa.reg.table.html">apa.reg.table</a></span>(basic.reg, <span class="dt">filename =</span> <span class="st">"Table2_APA.doc"</span>, <span class="dt">table.number =</span> <span class="dv">2</span>)</code></pre></div>
<div class="figure">
<img src="Table2.jpg" alt="Basic regression table in MSWord"><p class="caption">Basic regression table in MSWord</p>
</div>
</div>
<div id="blocks-regression-table" class="section level2">
<h2 class="hasAnchor">
<a href="#blocks-regression-table" class="anchor"></a>Blocks regression table</h2>
<p>In many cases, it is more useful for psychology researchers to compare the results of two regression models with common variables. This approach is known to many psychology researchers as block-based regression (likely due to the labeling used in popular software packages). Using regression to “control” for certain variables (e.g., demographic or socio-economic variables) is a common use case. In this scenario, the researcher conducts a regression with the “control” variables that is referred to as <em>block 1</em>. Following this, the researcher conducts a second regression with the “control” variables and the substantive variables that is referred to as <em>block 2</em>. If <em>block 2</em> accounts for significant variance in the criterion above and beyond <em>block 1</em> then substantive variables are deemed to be meaningful predictors.</p>
<p>A second common use of block-based regression in psychology is testing for continuous-variable interactions. Consider a scenario in which a researcher is testing for an interaction between two continuous variables and two regressions are conducted. The first regression includes the two predictors of interest (<em>block 1</em>). The second regression includes the two predictors of interest as well as their product term (<em>block 2</em>). If <em>block 2</em> accounts for significant variance in the criterion above and beyond <em>block 1</em> an interaction is deemed to be present. Admittedly interactions could be tested in a single regression; however, using a block-based regression for this analysis is common in psychology. The example below examines whether advertisements and amount of airplay for a song interact to predict album sales. The resulting table is presented in Table 3. Although this example only uses two blocks, note that any number of blocks can be used with the <strong>apa.reg.table</strong> function. As well, if the predictors in any of the blocks are a product-term, the zero-order correlation will be omitted from the output to prevent interpretation errors common in psychology.</p>
<p>The <strong>apa.reg.table</strong> function allows for multiple (i.e., more 2 or more) blocks as per below; see Table 3.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(apaTables)
block1 &lt;-<span class="st"> </span><span class="kw">lm</span>(sales <span class="op">~</span><span class="st"> </span>adverts <span class="op">+</span><span class="st"> </span>airplay, <span class="dt">data =</span> album)
block2 &lt;-<span class="st"> </span><span class="kw">lm</span>(sales <span class="op">~</span><span class="st"> </span>adverts <span class="op">+</span><span class="st"> </span>airplay <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(adverts<span class="op">*</span>airplay), <span class="dt">data =</span> album)
<span class="kw"><a href="../reference/apa.reg.table.html">apa.reg.table</a></span>(block1, block2, <span class="dt">filename =</span> <span class="st">"Table3_APA.doc"</span>, <span class="dt">table.number =</span> <span class="dv">3</span>)</code></pre></div>
<div class="figure">
<img src="Table3.jpg" alt="Blocks regression table in MSWord"><p class="caption">Blocks regression table in MSWord</p>
</div>
</div>
<div id="way-anova-and-d-value-tables" class="section level2">
<h2 class="hasAnchor">
<a href="#way-anova-and-d-value-tables" class="anchor"></a>1-way ANOVA and d-value tables</h2>
<p>There are three functions in apaTables that are helpful for 1-way ANOVA analyses within predictor variables that are independent (<strong>apa.aov.table</strong>, <strong>apa.1way.table</strong>, and <strong>apa.d.table</strong>). All three are illustrated below. First, however, the ANOVA must be conducted - we do so using the <em>viagra</em> dataset from Field et al. (2012). When conducting an ANOVA in R using the <strong>lm</strong> command you must ensure your independent variables are R factors and that contrasts are set correctly. Note: repeated measures designs are supported via the <strong>apa.ezANOVA.table</strong> command.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="st">"contr.sum"</span>, <span class="st">"contr.poly"</span>))
lm_output &lt;-<span class="st"> </span><span class="kw">lm</span>(libido <span class="op">~</span><span class="st"> </span>dose, <span class="dt">data =</span> viagra)</code></pre></div>
<p>The <strong>apa.aov.table</strong> function creates a 1-way ANOVA table based on lm_output; see Table 4.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(apaTables)
<span class="kw"><a href="../reference/apa.aov.table.html">apa.aov.table</a></span>(lm_output, <span class="dt">filename =</span> <span class="st">"Table4_APA.doc"</span>, <span class="dt">table.number =</span> <span class="dv">4</span>)</code></pre></div>
<div class="figure">
<img src="Table4.jpg" alt="1-way ANOVA table in MSWord"><p class="caption">1-way ANOVA table in MSWord</p>
</div>
<p>The <strong>apa.1way.table</strong> function creates a table with the mean and sd for each cell; see Table 5.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/apa.1way.table.html">apa.1way.table</a></span>(<span class="dt">iv =</span> dose, <span class="dt">dv =</span> libido, <span class="dt">data =</span> viagra, 
               <span class="dt">filename =</span> <span class="st">"Table5_APA.doc"</span>, 
               <span class="dt">table.number =</span> <span class="dv">5</span>)</code></pre></div>
<div class="figure">
<img src="Table5.jpg" alt="1-way M/SD table in MSWord"><p class="caption">1-way M/SD table in MSWord</p>
</div>
<p>The <strong>apa.d.table</strong> function show a d-value (with confidence interval) for each paired comparison; see Table 6.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/apa.d.table.html">apa.d.table</a></span>(<span class="dt">iv =</span> dose, <span class="dt">dv =</span> libido, <span class="dt">data =</span> viagra, 
            <span class="dt">filename =</span> <span class="st">"Table6_APA.doc"</span>, 
            <span class="dt">table.number =</span> <span class="dv">6</span>)</code></pre></div>
<div class="figure">
<img src="Table6.jpg" alt="1-way Paired Comparison d-values (with CI) in MSWord"><p class="caption">1-way Paired Comparison d-values (with CI) in MSWord</p>
</div>
</div>
<div id="n-way-anova-tables-2-way-example" class="section level2">
<h2 class="hasAnchor">
<a href="#n-way-anova-tables-2-way-example" class="anchor"></a>N-way ANOVA tables: 2-way Example</h2>
<p>The 2-way example with independent variable predictors is based on the <em>goggles</em> dataset from Field et al. (2012). As before, when conducting an ANOVA in <em>R</em> using the <strong>lm</strong> command you must ensure your independent variables are <em>R</em> factors and that contrasts are set correctly. Note: repeated measures designs are supported via the <strong>apa.ezANOVA.table</strong> command.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="st">"contr.sum"</span>, <span class="st">"contr.poly"</span>))
lm_output &lt;-<span class="st"> </span><span class="kw">lm</span>(attractiveness <span class="op">~</span><span class="st"> </span>gender<span class="op">*</span>alcohol, <span class="dt">data =</span> goggles)</code></pre></div>
<p>The <strong>apa.aov.table</strong> function creates a 2-way ANOVA table based on lm_output; see Table 7.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(apaTables)
<span class="kw"><a href="../reference/apa.aov.table.html">apa.aov.table</a></span>(lm_output, <span class="dt">filename =</span> <span class="st">"Table7_APA.doc"</span>, <span class="dt">table.number =</span> <span class="dv">7</span>)</code></pre></div>
<div class="figure">
<img src="Table7.jpg" alt="2-way ANOVA table in MSWord"><p class="caption">2-way ANOVA table in MSWord</p>
</div>
<p>The <strong>apa.2way.table</strong> function creates a table with the mean and sd for each cell; see Table 8. Marginal means can also be requested with the <em>show.marginal.means</em> = TRUE. For higher-order designs (i.e., 3-way or higher) use the <strong>filter</strong> command in the <em>tidyverse</em> package to select the subset of rows and then use <strong>apa.2way.table</strong> to display cell statistics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/apa.2way.table.html">apa.2way.table</a></span>(<span class="dt">iv1 =</span> gender,<span class="dt">iv2 =</span> alcohol, <span class="dt">dv =</span> attractiveness, 
               <span class="dt">data =</span> goggles, 
               <span class="dt">filename =</span> <span class="st">"Table8_APA.doc"</span>, 
               <span class="dt">show.marginal.means =</span> <span class="ot">TRUE</span>,
               <span class="dt">table.number =</span> <span class="dv">8</span>)</code></pre></div>
<div class="figure">
<img src="Table8.jpg" alt="2-way M/SD table in MSWord"><p class="caption">2-way M/SD table in MSWord</p>
</div>
<p>You can use the <em>tidyverse</em> package to conducted paired comparisons within each gender again using <strong>apa.d.table</strong>; see Tables 9 and 10.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(apaTables)
<span class="kw">library</span>(dplyr)
goggles.men   &lt;-<span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(goggles,gender<span class="op">==</span><span class="st">"Male"</span>)
goggles.women &lt;-<span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(goggles,gender<span class="op">==</span><span class="st">"Female"</span>)

<span class="kw"><a href="../reference/apa.d.table.html">apa.d.table</a></span>(<span class="dt">iv =</span> alcohol, <span class="dt">dv =</span> attractiveness, 
            <span class="dt">data =</span> goggles.men, 
            <span class="dt">filename =</span> <span class="st">"Table9_APA.doc"</span>, 
            <span class="dt">table.number =</span> <span class="dv">9</span>)

<span class="kw"><a href="../reference/apa.d.table.html">apa.d.table</a></span>(<span class="dt">iv =</span> alcohol, <span class="dt">dv =</span> attractiveness, 
            <span class="dt">data =</span> goggles.women, 
            <span class="dt">filename =</span> <span class="st">"Table10_APA.doc"</span>, 
            <span class="dt">table.number =</span> <span class="dv">10</span>)</code></pre></div>
<div class="figure">
<img src="Table9.jpg" alt="Subgroups for Paired Comparison d-values (with CI) in MSWord"><p class="caption">Subgroups for Paired Comparison d-values (with CI) in MSWord</p>
</div>
</div>
<div id="ezanova-and-apatables-repeated-measures-anova" class="section level2">
<h2 class="hasAnchor">
<a href="#ezanova-and-apatables-repeated-measures-anova" class="anchor"></a>ezANOVA and apaTables: Repeated measures ANOVA</h2>
<p>apaTables also supports repeated measures ANOVA tables and repeated measures by between measures (mixed) ANOVA tables via <strong>ezANOVA</strong> output from the <em>ez</em> package.</p>
<div id="repeated-measures-2-way-design" class="section level3">
<h3 class="hasAnchor">
<a href="#repeated-measures-2-way-design" class="anchor"></a>Repeated Measures: 2-way design</h3>
<p>Prior to begining we ‘open’ the <em>apaTables</em>, <em>tidyverse</em>, and <em>ez</em> packages using the library command as per below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(apaTables)
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(ez)</code></pre></div>
<p>In this example, we used the <em>drink_attitude</em> dataset from Field et al. (2012). As before, this dataset is built into <em>apaTables</em> so it does not need to be loaded using <strong>read_csv</strong> or <strong>read_sav</strong>. The dataset (<em>drink_attitude_wide</em>) can be inspected with the <strong>glimpse</strong> command below (this provides information similar to SPSS variable view). We use the “wide” descriptor in the name of the dataset to remind us that the data is in in the “wide” format where one row contains all the data for one person. There are 20 participants so there are 20 rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(drink_attitude_wide)</code></pre></div>
<pre><code>## Observations: 20
## Variables: 10
## $ participant    &lt;fct&gt; P1, P2, P3, P4, P5, P6, P7, P8, P9, P10, P11, P...
## $ beer_positive  &lt;int&gt; 1, 43, 15, 40, 8, 17, 30, 34, 34, 26, 1, 7, 22,...
## $ beer_negative  &lt;int&gt; 6, 30, 15, 30, 12, 17, 21, 23, 20, 27, -19, -18...
## $ beer_neutral   &lt;int&gt; 5, 8, 12, 19, 8, 15, 21, 28, 26, 27, -10, 6, 4,...
## $ wine_positive  &lt;int&gt; 38, 20, 20, 28, 11, 17, 15, 27, 24, 23, 28, 26,...
## $ wine_negative  &lt;int&gt; -5, -12, -15, -4, -2, -6, -2, -7, -10, -15, -13...
## $ wine_neutral   &lt;int&gt; 4, 4, 6, 0, 6, 6, 16, 7, 12, 14, 13, 19, 14, 21...
## $ water_positive &lt;int&gt; 10, 9, 6, 20, 27, 9, 19, 12, 12, 21, 33, 23, 21...
## $ water_negative &lt;int&gt; -14, -10, -16, -10, 5, -6, -20, -12, -9, -6, -2...
## $ water_neutral  &lt;int&gt; -2, -13, 1, 2, -5, -13, 3, 2, 4, 0, 9, 5, 0, 4,...</code></pre>
<p>The dataset represents an ANOVA with two repeated measures factors. It is a 3 <em>drinks</em> (wine, beer, water) X 3 <em>imagery</em> (positive, negative, neutral) design. The dataset uses 10 columns to represent this design. The first column contains a code for each participant (P1, P2, etc.) Note that the <em>participant</em> column is a factor as indicated by the &lt; fctr &gt; descriptor. The <em>participant</em> column must be a factor which can, as noted previously, be created by the <strong>as_factor</strong> command.</p>
<p>Each of the remaining 9 columns contain atittude ratings for a single <em>drink/imagery</em> combination cell. The naming convention for column names is critical to the workflow we describe below. Each column name represents the level of the <em>drink</em> variable separated using an underscore ( _ ) from a level of the <em>imagery</em> variable. For example the first column is called <em>beer_positive</em> representing the cell with a combination of the the <em>beer</em> level of <em>drink</em> and the positive level of <em>imagery</em>. Each value in this column represents <em>attitude</em> for a participant in this cell.</p>
<p>In order to conduct a repeated measures ANOVA we need to convert the dataset from the wide format (where each row represents a person) to the long format (where each row represents a single observation from a person). We do this with a series of commands below.</p>
<p>First we rearrange the data so that each row represents a single observation from a person using the <strong>gather</strong> command from the <em>tidyverse</em> package. The command creates a new dataset where there is a <em>participant</em> column, a <em>cell</em> column that indicates the cell an observation came from (e.g., beer_positive) and an <em>attitude</em> column that contains the attitude rating. In this dataset there is one row per observation. Note that in the command below we use, <em>beer_positive:water_neutral</em> to select all the columns in the dataset between/including beer_positive to water_neutral (i.e., all nine columns). The columns must be in a block in the dataset without other variables interspersed between them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">drink_attitude_long &lt;-<span class="st"> </span><span class="kw">gather</span>(<span class="dt">data =</span> drink_attitude_wide,
                              <span class="dt">key =</span> cell, <span class="dt">value =</span> attitude,
                              beer_positive<span class="op">:</span>water_neutral,
                              <span class="dt">factor_key=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>In this new long dataset each of the 20 particpants has nine observations (i.e., nine cells) so there are 180 rows. The problem with data resulting from the above command is that the levels of <em>drink</em> and <em>imagery</em> are combined into a single column called <em>cell</em>. That is cell contains the information in the form beer_positive (i.e., the previous column names for each cell). We can split those levels off into their own columns with the names <em>drink</em> and <em>imagery</em> and turn those columns into factors with the commands below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">drink_attitude_long &lt;-<span class="st"> </span><span class="kw">separate</span>(<span class="dt">data =</span> drink_attitude_long,
                                <span class="dt">col =</span> cell, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">"drink"</span>,<span class="st">"imagery"</span>),
                                <span class="dt">sep =</span> <span class="st">"_"</span>, <span class="dt">remove =</span> <span class="ot">TRUE</span>)

drink_attitude_long<span class="op">$</span>drink &lt;-<span class="st"> </span><span class="kw">as_factor</span>(drink_attitude_long<span class="op">$</span>drink)
drink_attitude_long<span class="op">$</span>imagery &lt;-<span class="st"> </span><span class="kw">as_factor</span>(drink_attitude_long<span class="op">$</span>imagery)</code></pre></div>
<p>We can inspect the final long version of the dataset with glimpse again:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(drink_attitude_long)</code></pre></div>
<pre><code>## Observations: 180
## Variables: 4
## $ participant &lt;fct&gt; P1, P2, P3, P4, P5, P6, P7, P8, P9, P10, P11, P12,...
## $ drink       &lt;fct&gt; beer, beer, beer, beer, beer, beer, beer, beer, be...
## $ imagery     &lt;fct&gt; positive, positive, positive, positive, positive, ...
## $ attitude    &lt;int&gt; 1, 43, 15, 40, 8, 17, 30, 34, 34, 26, 1, 7, 22, 30...</code></pre>
<p>This output reveals the new data structure. There are now only four columns where each row represents a single observation for a participant. As before, the first column is factor column representing <em>participant</em>. But each participant is represented nines times in this column now - because each participant has nine observations (i.e., one in each of the nine cells). Most importantly, we now have a single column indicating level of <em>drink</em>, a single column indicating level of <em>imagery</em>, and a column indicating the <em>attitude</em> rating.</p>
<p>You can see the first few rows in the more familiar format below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(drink_attitude_long)</code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   participant drink imagery  attitude
##   &lt;fct&gt;       &lt;fct&gt; &lt;fct&gt;       &lt;int&gt;
## 1 P1          beer  positive        1
## 2 P2          beer  positive       43
## 3 P3          beer  positive       15
## 4 P4          beer  positive       40
## 5 P5          beer  positive        8
## 6 P6          beer  positive       17</code></pre>
<p>Prior to conducting the analysis we set the contrasts as per Field et al. (2012).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">alcohol_vs_water &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>)
beer_vs_wine &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)
negative_vs_other &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>)
positive_vs_neutral &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)
<span class="kw">contrasts</span>(drink_attitude_long<span class="op">$</span>drink) &lt;-<span class="st"> </span><span class="kw">cbind</span>(alcohol_vs_water, beer_vs_wine)
<span class="kw">contrasts</span>(drink_attitude_long<span class="op">$</span>imagery) &lt;-<span class="st"> </span><span class="kw">cbind</span>(negative_vs_other, positive_vs_neutral)</code></pre></div>
<p>Then we use the <strong>ezANOVA</strong> command from the <em>ez</em> package to conduct the repeated measures ANOVA. Be sure to include all of the commands below including the options command which ensures that the output has sufficent number of digits (i.e., numbers after the decimal) for <em>apaTables</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">10</span>)
drink_attitude_results &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ez/topics/ezANOVA">ezANOVA</a></span>(<span class="dt">data =</span> drink_attitude_long,
                   <span class="dt">dv =</span> .(attitude), <span class="dt">wid =</span> .(participant),
                   <span class="dt">within =</span> .(drink, imagery),
                   <span class="dt">type =</span> <span class="dv">3</span>, <span class="dt">detailed =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Now we make the table based on the output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/apa.ezANOVA.table.html">apa.ezANOVA.table</a></span>(drink_attitude_results, 
                  <span class="dt">table.number =</span> <span class="dv">11</span>,
                  <span class="dt">filename=</span><span class="st">"Table11_APA.doc"</span>)</code></pre></div>
<div class="figure">
<img src="Table10.jpg" alt="2-way Repeated Measures ANOVA in MSWord"><p class="caption">2-way Repeated Measures ANOVA in MSWord</p>
</div>
</div>
<div id="repeated-measures-and-independent-groups-3-way-design" class="section level3">
<h3 class="hasAnchor">
<a href="#repeated-measures-and-independent-groups-3-way-design" class="anchor"></a>Repeated Measures and Independent Groups: 3-way design</h3>
<p>Prior to begining we ‘open’ the <em>apaTables</em>, <em>tidyverse</em>, and <em>ez</em> packages using the library command as per below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(apaTables)
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(ez)</code></pre></div>
<p>In this example, we used the drink_attitude dataset from Field et al. (2012). As before, this dataset is built into apaTables. The dataset (<em>dating_wide</em>) can be inspected with the <strong>glimpse</strong> command below (this provides information similar to SPSS variable view). We use the “wide” descriptor in the name of the dataset to remind us that the data is in in the “wide” format where one row contains all the data for one person. There are 20 participants so there are 20 rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(dating_wide)</code></pre></div>
<pre><code>## Observations: 20
## Variables: 11
## $ participant     &lt;fct&gt; P01, P02, P03, P04, P05, P06, P07, P08, P09, P...
## $ gender          &lt;fct&gt; Male, Male, Male, Male, Male, Male, Male, Male...
## $ attractive_high &lt;int&gt; 86, 91, 89, 89, 80, 80, 89, 100, 90, 89, 89, 8...
## $ average_high    &lt;int&gt; 84, 83, 88, 69, 81, 84, 85, 94, 74, 86, 91, 90...
## $ ugly_high       &lt;int&gt; 67, 53, 48, 58, 57, 51, 61, 56, 54, 63, 93, 85...
## $ attractive_some &lt;int&gt; 88, 83, 99, 86, 88, 96, 87, 86, 92, 80, 88, 95...
## $ average_some    &lt;int&gt; 69, 74, 70, 77, 71, 63, 79, 71, 71, 73, 65, 70...
## $ ugly_some       &lt;int&gt; 50, 48, 48, 40, 50, 42, 44, 54, 58, 49, 54, 60...
## $ attractive_none &lt;int&gt; 97, 86, 90, 87, 82, 92, 86, 84, 78, 91, 55, 50...
## $ average_none    &lt;int&gt; 48, 50, 45, 47, 50, 48, 50, 54, 38, 48, 48, 44...
## $ ugly_none       &lt;int&gt; 47, 46, 48, 53, 45, 43, 45, 47, 45, 39, 52, 45...</code></pre>
<p>The dataset represents an ANOVA with one independent groups factor and two repeated measures factors. It is a 2 <em>gender</em> (male, female) by 3 <em>looks</em> (attrative, average, ugly) X 3 <em>personality</em> (high, some, none) design. The dataset uses 11 columns to represent this design. The first column contains a code for each participant (P1, P2, etc.) Note that the <em>participant</em> column is a factor as indicated by the “&lt; fctr &gt;” descriptor. The second column is used to indicate the gender of each participant. Both the <em>participant</em> and <em>gender</em> columns are factors.</p>
<p>Each of the remaining 9 columns contain atittude ratings for a single <em>looks/personality</em> combination cell. The naming convention for column names is critical to the workflow we describe below. Each column name represents the level of the <em>looks</em> variable separated using an underscore ( _ ) from a level of the <em>personality</em> variable. For example the first column is called <em>attractive_high</em> representing the cell with a combination of the the attractive level of <em>looks</em> and the high level of <em>personality</em>. Each value in this column represents <em>date rating</em> for a participant in this cell.</p>
<p>In order to conduct a mixed between/within ANOVA we need to convert the dataset from the wide format (where each row represents a person) to the long format (where each row represents a single observation from a person) – taking into account the independent groups factors (<em>gender</em>). We do this with a series of commands below.</p>
<p>First we rearrange the data so that each row represents a single observation from a person using the <strong>gather</strong> command from the <em>tidyverse</em> package. The command creates a new dataset where there is a <em>participant</em> column, a <em>cell</em> column that indicates the cell an observation came from (e.g., attractive_high) and an <em>date_rating</em> column. Note that in the command below we use, <em>attractive_high:ugly_none</em> to select all the columns in the dataset between/including <em>attractive_high</em> to <em>ugly_none</em> (i.e., all nine columns). The columns must be in a block in the dataset without other variables interspersed between them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dating_long &lt;-<span class="st"> </span><span class="kw">gather</span>(<span class="dt">data =</span> dating_wide,
                     <span class="dt">key =</span> cell, <span class="dt">value =</span> date_rating,
                     attractive_high<span class="op">:</span>ugly_none,
                     <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>In this new long dataset each of the 20 particpants hasn nine observations (i.e., nine cells) in addition to their gender classification. As a result, there are 180 rows in the long version of this dataset. The problem with data resulting from the above command is that the levels of <em>looks</em> and <em>personality</em> are combined into a single column called <em>cell</em>. That is cell contains the information in the form beer_positive (i.e., the previous column names for each cell). We can split those levels off into their own columns with the names “looks” and “personality” and turn those columns into factors with the commands below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dating_long &lt;-<span class="st"> </span><span class="kw">separate</span>(<span class="dt">data =</span> dating_long,
                       <span class="dt">col =</span> cell, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">"looks"</span>,<span class="st">"personality"</span>),
                       <span class="dt">sep =</span> <span class="st">"_"</span>, <span class="dt">remove =</span> <span class="ot">TRUE</span>)

dating_long<span class="op">$</span>looks &lt;-<span class="st"> </span><span class="kw">as_factor</span>(dating_long<span class="op">$</span>looks)
dating_long<span class="op">$</span>personality &lt;-<span class="st"> </span><span class="kw">as_factor</span>(dating_long<span class="op">$</span>personality)</code></pre></div>
<p>We can inspect the final long version of the dataset with glimpse again:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://dplyr.tidyverse.org/reference/reexports.html">glimpse</a></span>(dating_long)</code></pre></div>
<pre><code>## Observations: 180
## Variables: 5
## $ participant &lt;fct&gt; P01, P02, P03, P04, P05, P06, P07, P08, P09, P10, ...
## $ gender      &lt;fct&gt; Male, Male, Male, Male, Male, Male, Male, Male, Ma...
## $ looks       &lt;fct&gt; attractive, attractive, attractive, attractive, at...
## $ personality &lt;fct&gt; high, high, high, high, high, high, high, high, hi...
## $ date_rating &lt;int&gt; 86, 91, 89, 89, 80, 80, 89, 100, 90, 89, 89, 84, 9...</code></pre>
<p>This output reveals the new data structure. There are now only five columns where each row represents a single observation for a participant. As before, the first column is factor column representing <em>participant</em>. But each participant is represented nines times in this column now - because each participant has nine observations (i.e., one in each of the nine cells). The second column contains the <em>gender</em> factor. The third column indicates the level of <em>looks</em>, and the fourth column indicates the level of <em>personality</em>. The fith column indicates the <em>date_rating</em>.</p>
<p>You can see the first few rows in the more familiar format below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(dating_long)</code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   participant gender looks      personality date_rating
##   &lt;fct&gt;       &lt;fct&gt;  &lt;fct&gt;      &lt;fct&gt;             &lt;int&gt;
## 1 P01         Male   attractive high                 86
## 2 P02         Male   attractive high                 91
## 3 P03         Male   attractive high                 89
## 4 P04         Male   attractive high                 89
## 5 P05         Male   attractive high                 80
## 6 P06         Male   attractive high                 80</code></pre>
<p>Prior to conducting the analysis we set the contrasts as per Field et al. (2012).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">some_vs_none &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>)
hi_vs_av &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>)
attractive_vs_ugly &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>)
attractive_vs_average &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>)
<span class="kw">contrasts</span>(dating_long<span class="op">$</span>personality) &lt;-<span class="st"> </span><span class="kw">cbind</span>(some_vs_none, hi_vs_av)
<span class="kw">contrasts</span>(dating_long<span class="op">$</span>looks) &lt;-<span class="st"> </span><span class="kw">cbind</span>(attractive_vs_ugly, attractive_vs_average)</code></pre></div>
<p>Then we use the <strong>ezANOVA</strong> command from the <em>ez</em> package to conduct the repeated measures ANOVA. Be sure to include all of the commands below including the options command which ensures that the output has sufficent number of digits (i.e., numbers after the decimal) for apaTables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">10</span>)
dating_results &lt;-<span class="kw"><a href="http://www.rdocumentation.org/packages/ez/topics/ezANOVA">ezANOVA</a></span>(<span class="dt">data =</span> dating_long, 
                         <span class="dt">dv =</span> .(date_rating), <span class="dt">wid =</span> .(participant),
                        <span class="dt">between =</span> .(gender), <span class="dt">within =</span> .(looks, personality),
                        <span class="dt">type =</span> <span class="dv">3</span>, <span class="dt">detailed =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Now we make the table based on the output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dating_table &lt;-<span class="st"> </span><span class="kw"><a href="../reference/apa.ezANOVA.table.html">apa.ezANOVA.table</a></span>(dating_results, 
                                  <span class="dt">filename =</span> <span class="st">"Table12_APA.doc"</span>, 
                                  <span class="dt">table.number =</span> <span class="dv">12</span>)
<span class="kw">print</span>(dating_table)</code></pre></div>
<div class="figure">
<img src="Table11.jpg" alt="3-way Mixed Measures ANOVA in MSWord"><p class="caption">3-way Mixed Measures ANOVA in MSWord</p>
</div>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Field, A., Miles, J., Field, Z. <em>Discovering statistics using R</em>. Sage: Chicago.</p>
<p>Nuijten, M. B., Hartgerink, C. H. J., van Assen, M. A. L. M., Epskamp, S., &amp; Wicherts, J. M. (2015). The prevalence of statistical reporting errors in psychology (1985-2013). <em>Behavior Research Methods</em>. <a href="http://doi.org/10.3758/s13428-015-0664-2" class="uri">http://doi.org/10.3758/s13428-015-0664-2</a></p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Technically the tables are in .rtf format. But you should end all files with .doc; this will ensure they are automatically loaded by Microsoft Word<a href="#fnref1">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#context">Context</a></li>
      <li><a href="#correlation-table">Correlation table</a></li>
      <li><a href="#regression-table-overview">Regression table overview</a></li>
      <li><a href="#basic-regression-table">Basic regression table</a></li>
      <li><a href="#blocks-regression-table">Blocks regression table</a></li>
      <li><a href="#way-anova-and-d-value-tables">1-way ANOVA and d-value tables</a></li>
      <li><a href="#n-way-anova-tables-2-way-example">N-way ANOVA tables: 2-way Example</a></li>
      <li><a href="#ezanova-and-apatables-repeated-measures-anova">ezANOVA and apaTables: Repeated measures ANOVA</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by David Stanley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
